$pass = ConvertTo-SecureString "<Password>" -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential -ArgumentList "<user>", $pass
# Download OSSLScan.zip file
Invoke-WebRequest -Uri "https://github.com/Qualys/log4jscanwin/releases/download/2.1.3.0/Log4jScanner-2.1.3.0.zip" -Proxy http://<ip:port> -ProxyCredential $cred -UseBasicParsing -OutFile $env:TEMP\Log4jScanner-2.1.3.0.zip
# Unzip downloaded file
Expand-Archive $env:TEMP\Log4jScanner-2.1.3.0.zip -DestinationPath $env:TEMP\

$Arch = (Get-Process -Id $PID).StartInfo.EnvironmentVariables["PROCESSOR_ARCHITECTURE"];
if ($Arch -eq 'x86') {
    # Start scan process
    cd $env:TEMP\Log4jScanner\x86
    .\Log4jScanner.exe /scan report_sig | Out-Null
}
elseif ($Arch -eq 'amd64') {
    # Start scan process
    cd $env:TEMP\Log4jScanner\x64
    .\Log4jScanner.exe /scan /report_sig | Out-Null
}

Get-Content C:\ProgramData\Qualys\log4j_findings.out
""
""
Get-Content C:\ProgramData\Qualys\log4j_summary.out